# 更新日志

## [1.8.0] - 2024-12-19

### 🎯 重大新功能：已认识单词管理
- ✅ **"认识"按钮**: 在收藏单词列表中添加绿色"认识"按钮，一键标记已掌握的单词
- 📊 **学习进度统计**: 新增"已认识单词"数量统计，实时显示学习成果
- 📝 **已认识单词列表**: 独立的已认识单词管理区域，支持查看、删除操作
- 🗂️ **智能分类管理**: 将学习中的单词与已掌握的单词分开管理，提升学习效率

### 🔧 功能增强
- 🎨 **界面优化**: 新增已认识单词section，采用清晰的视觉设计
- 💾 **数据完整性**: 已认识单词支持完整的数据导出/导入功能
- 🔄 **跨页面同步**: 已认识单词状态在所有标签页间实时同步
- 🕒 **时间记录**: 自动记录单词的认识时间，便于学习回顾

### 🎛️ 操作体验
- 🖱️ **悬停详情**: 已认识单词支持鼠标悬停查看完整翻译信息
- 🗑️ **批量管理**: 支持单个删除和批量清空已认识单词
- 💬 **智能提示**: 操作成功/失败的友好消息提示
- 🔘 **按钮状态**: 智能的按钮启用/禁用状态管理

### 📈 学习体验提升
- 🎯 **进度可视化**: 清晰展示收藏单词数量和已认识单词数量
- 🔄 **学习循环**: 支持"收藏 → 学习 → 认识"的完整学习流程
- 📚 **知识积累**: 帮助用户建立个人词汇成就感和学习动力
- 🎉 **成就感**: 通过已认识单词列表展示学习成果

### 🛠️ 技术改进
- 📦 **存储扩展**: 新增KNOWN_WORDS和KNOWN_WORDS_DATA存储键
- 🔧 **代码优化**: 重构数据管理逻辑，提高代码可维护性
- 🧪 **测试支持**: 新增专门的测试页面验证功能完整性
- 📊 **版本升级**: 数据格式版本升级到1.8.0，支持向后兼容

---

## [1.7.8] - 2024-12-19

### 核心功能修复
- 🛡️ **修复扩展上下文失效错误**: 解决"Extension context invalidated"导致的收藏功能失败问题
- 💾 **智能数据保护**: 即使扩展上下文失效，单词仍会保存到内存中，避免数据丢失
- 🔄 **自动恢复机制**: 扩展上下文恢复后自动同步内存数据到存储
- ⚡ **优雅降级**: 存储失败时功能仍可正常使用，不影响用户体验

### 技术优化
- 🔧 添加扩展上下文有效性检查函数
- 🛠️ 实现安全的存储操作包装器，自动处理上下文失效
- 📦 优化错误处理逻辑，区分不同类型的错误
- 🎯 改进UI更新机制，确保界面状态与内存数据一致

### 用户体验改进
- 💫 收藏操作更加稳定，不会因为扩展重载而失败
- 🎨 添加友好的错误提示，告知用户操作状态
- 📱 优化长时间使用的稳定性，减少功能中断

### 稳定性提升
- 🔒 防止扩展重载、更新时的数据丢失
- ⚡ 提高在复杂页面环境下的可靠性
- 🌐 增强与其他扩展和页面脚本的兼容性

---

## [1.7.7] - 2024-12-19

### 稳定性改进
- 🛡️ **增强错误处理**: 为所有DOM操作添加安全检查，避免与页面其他脚本冲突
- 🔒 **防护机制**: 添加element有效性检查，防止操作已移除的DOM元素
- ⚡ **异步安全**: 在异步操作后重新验证DOM元素状态
- 🎯 **精确错误定位**: 为每个函数添加try-catch包装，提供详细错误信息

### 技术优化
- 🔧 优化showWordTooltip函数，添加element连接性检查
- 🛠️ 改进createTooltip函数，确保document.body存在性验证
- 📦 强化事件处理函数，防止undefined属性访问
- 🎨 优化初始化流程，单个功能失败不影响其他功能

### 兼容性提升
- 🌐 解决与百度搜索等复杂页面的JavaScript冲突问题
- 📱 提高在各种网站环境下的稳定性
- 🔄 增强扩展的容错能力和恢复机制

---

## [1.7.6] - 2024-12-19

### 用户体验统一
- 🖱️ **网页弹窗悬停隐藏**: 网页上的翻译弹窗现在也支持鼠标离开时自动隐藏
- 🎯 **统一交互体验**: 网页翻译弹窗与收藏页面弹窗现在具有一致的悬停行为
- 💫 **智能状态管理**: 使用data-hover属性精确控制网页弹窗的显示/隐藏状态
- ⚡ **响应式隐藏**: 鼠标离开单词或弹窗时，200ms延迟后自动隐藏

### 技术改进
- 🔧 统一content.js和popup.js的悬停事件处理逻辑
- 🛠️ 使用data-hover属性替代:hover伪类检查，提高可靠性
- 📦 移除网页弹窗的点击外部关闭逻辑，简化代码结构
- 🎨 保持所有原有功能完整性，仅优化交互方式

---

## [1.7.5] - 2024-12-19

### 用户体验优化
- 🖱️ **改进收藏页面交互**: 将点击显示单词详情改为鼠标悬停显示
- ⚡ **即时响应**: 鼠标移动到收藏的单词上即可立即查看详细信息
- 🎯 **智能隐藏**: 鼠标离开单词或详情弹窗时自动隐藏，操作更流畅
- 💫 **平滑过渡**: 添加200ms延迟，给用户足够时间在单词和弹窗间移动

### 技术改进
- 🔧 优化事件处理逻辑，使用mouseenter/mouseleave替代click事件
- 🛠️ 改进提示框的悬停状态管理，使用data-hover属性精确控制
- 📦 移除不必要的点击外部关闭逻辑，简化代码结构

---

## [1.7.4] - 2024-12-19

### 问题修复
- 🔧 **修复网页翻译弹窗滚动问题**: 解决在网页上选词翻译时，弹窗内容过多无法滚动查看的问题
- 📱 **优化网页弹窗定位**: 智能调整网页翻译弹窗位置，避免超出屏幕边界
- 🎨 **统一滚动条样式**: 为网页翻译弹窗添加与popup一致的美观滚动条
- 📏 **响应式高度控制**: 网页翻译弹窗也支持最大高度80vh限制

### 技术改进
- 🛠️ 优化content.js中的createTooltip函数，支持智能定位
- 📦 在content.css中添加滚动条美化样式
- 🔄 统一popup和网页翻译的用户体验

---

## [1.7.3] - 2024-12-19

### 问题修复
- 🔧 **修复弹窗滚动问题**: 解决收藏单词详情弹窗内容过多时无法滚动查看的问题
- 📱 **优化弹窗定位**: 智能调整弹窗位置，避免超出屏幕边界
- 🎨 **美化滚动条**: 为弹窗添加美观的自定义滚动条样式
- 📏 **响应式高度**: 弹窗最大高度限制为80vh，确保在不同屏幕尺寸下都能正常显示

### 技术改进
- 🛠️ 优化弹窗定位算法，支持上下左右智能调整
- 📦 添加滚动条美化CSS，提升用户体验

---

## [1.7.2] - 2024-12-19

### 功能完善
- 🔍 **完善收藏单词详情显示**: 现在点击收藏单词可查看完整的翻译信息
- 📚 **词典功能增强**: 显示词性分类、英文定义、使用例句、同义词等详细信息
- 🌐 **API集成优化**: 集成Dictionary API获取专业词典数据
- 🎨 **UI样式完善**: 添加词性、例句、同义词等元素的完整样式支持

### 技术优化
- 🔧 完全复用content.js中的翻译逻辑和UI组件
- 🛠️ 优化翻译数据获取，支持MyMemory和Dictionary API
- 📦 添加完整的CSS样式支持，保持视觉一致性

---

## [1.7.1] - 2024-12-19

### 新增功能
- 🔍 **收藏单词详情查看**: 在扩展弹出页面中点击收藏的单词可查看详细信息
- 📖 **UI复用**: 复用网页划词翻译的UI组件，保持一致的用户体验
- 🔊 **完整功能**: 支持发音播放、音标显示、翻译信息等完整功能
- ❤️ **收藏管理**: 在详情弹窗中可直接取消收藏单词

### 功能改进
- 🎯 为收藏单词列表中的单词文本添加了点击交互
- 💫 优化了弹窗定位和显示效果
- 🎨 添加了加载状态和错误状态的友好提示

### 技术优化
- 🔧 在popup.js中实现了翻译UI组件的复用
- 🛠️ 优化了数据获取逻辑，优先使用本地缓存
- 📦 添加了完整的事件处理和状态管理

---

## [1.7.0] - 2024-12-19

### 新增功能
- ✨ **长文本翻译功能**: 选中包含英文的长句或段落时，自动显示蓝色🌐翻译按钮
- 🎯 **智能识别**: 自动区分单词翻译（📖图标）和文本翻译（🌐图标）
- 🌐 **多源文本翻译**: 支持微软翻译和MyMemory翻译API进行长文本翻译
- 💫 **优雅界面**: 为长文本翻译设计了专门的UI界面，清晰显示原文和译文

### 功能改进
- 📝 优化了文本选择逻辑，更准确地识别英文内容
- 🎨 为长文本翻译按钮添加了独特的蓝色渐变样式
- 📱 改进了翻译结果的显示布局，支持长文本的良好展示

### 技术优化
- 🔧 重构了翻译逻辑，分离单词翻译和文本翻译功能
- 🛠️ 添加了专门的长文本翻译API调用函数
- 📦 优化了代码结构，提高了可维护性

---

## [1.6.5] - 之前版本

### 功能特点
- 🔍 智能单词识别和翻译
- 📖 多源翻译API支持
- ❤️ 单词收藏功能
- 🎨 智能高亮显示
- 🔊 双语音发音支持
- 💾 数据持久化和备份 